import Link from 'next/link'
import { Tabs, Tab, Callout } from 'nextra-theme-docs'


<div class="phpdocumentor-element -file">
    ## um-filters-avatars.php

        

    <section class="phpdocumentor-functions">
### Functions
<div class="phpdocumentor-element -function - ">
 #### um_avatar_defaults()
       

<div class="phpdocumentor-element-found-in">
    <Link href="../files/includes-core-um-filters-avatars.html#source-view.11">includes/core/um-filters-avatars.php</Link> : <span class="phpdocumentor-element-found-in__line">11</span>
</div>

<div class="phpdocumentor-summary">
Do not apply to backend default avatars
</div>


    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">um_avatar_defaults</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$avatar_defaults`</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span>



    ##### Parameters
    <dl class="phpdocumentor-argument-list">
                    
                <span class="phpdocumentor-signature__argument__name">`$avatar_defaults`</span>
                : <span class="phpdocumentor-signature__argument__return-type"></span>
                            
           
                 

           
            </dl>



<div className="py-4"></div>

</div>
<div class="phpdocumentor-element -function - ">
 #### um_get_avatar()
       

<div class="phpdocumentor-element-found-in">
    <Link href="../files/includes-core-um-filters-avatars.html#source-view.29">includes/core/um-filters-avatars.php</Link> : <span class="phpdocumentor-element-found-in__line">29</span>
</div>

<div class="phpdocumentor-summary">
Get user UM avatars
</div>


    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">um_get_avatar</span><span>(</span><span class="phpdocumentor-signature__argument"><span>[</span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$avatar`</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$id_or_email`</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$size`</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;96&#039;</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$avatar_class`</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$default`</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$alt`</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span>



    ##### Parameters
    <dl class="phpdocumentor-argument-list">
                    
                <span class="phpdocumentor-signature__argument__name">`$avatar`</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>            
           
                 

           
                    
                <span class="phpdocumentor-signature__argument__name">`$id_or_email`</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>            
           
                 

           
                    
                <span class="phpdocumentor-signature__argument__name">`$size`</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;96&#039;</span>            
           
                 

           
                    
                <span class="phpdocumentor-signature__argument__name">`$avatar_class`</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>            
           
                 

           
                    
                <span class="phpdocumentor-signature__argument__name">`$default`</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>            
           
                 

           
                    
                <span class="phpdocumentor-signature__argument__name">`$alt`</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>            
           
                 

           
            </dl>


    ##### Tags
     
    <div class="phpdocumentor-tag-list">
                                   
                        </div>

<div className="py-4"></div>

</div>
<div class="phpdocumentor-element -function - ">
 #### um_filter_get_avatar_url()
       

<div class="phpdocumentor-element-found-in">
    <Link href="../files/includes-core-um-filters-avatars.html#source-view.58">includes/core/um-filters-avatars.php</Link> : <span class="phpdocumentor-element-found-in__line">58</span>
</div>

<div class="phpdocumentor-summary">
Replace Gravatar image URL to Ultimate member profile image URL if setting &quot;Use Gravatars?&quot; disabled
</div>


    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">um_filter_get_avatar_url</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$url`</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$id_or_email`</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$args`</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span>



    ##### Parameters
    <dl class="phpdocumentor-argument-list">
                    
                <span class="phpdocumentor-signature__argument__name">`$url`</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            
           
                 

           
                    
                <span class="phpdocumentor-signature__argument__name">`$id_or_email`</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                            
           
                 

           
                    
                <span class="phpdocumentor-signature__argument__name">`$args`</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;</span>
                            
           
                 

           
            </dl>



<div className="py-4"></div>

</div>
</section>

       ```php showLineNumbers=true copy
       <?php if ( ! defined( 'ABSPATH' ) ) exit; // Exit if accessed directly


/**
 * Do not apply to backend default avatars
 *
 * @param $avatar_defaults
 *
 * @return mixed
 */
function um_avatar_defaults( $avatar_defaults ) {
	remove_filter( 'get_avatar', 'um_get_avatar', 99999 );
	return $avatar_defaults;
}
add_filter( 'avatar_defaults', 'um_avatar_defaults', 99999 );


/**
 * Get user UM avatars
 * @param  string $avatar
 * @param  string $id_or_email
 * @param  string $size
 * @param  string $avatar_class
 * @param  string $default
 * @param  string $alt
 * @hooks  filter `get_avatar`
 * @return string returns avatar in image html elements
 */
function um_get_avatar( $avatar = '', $id_or_email='', $size = '96', $avatar_class = '', $default = '', $alt = '' ) {
	if ( is_numeric($id_or_email) )
		$user_id = (int) $id_or_email;
	elseif ( is_string( $id_or_email ) && ( $user = get_user_by( 'email', $id_or_email ) ) )
		$user_id = $user->ID;
	elseif ( is_object( $id_or_email ) && ! empty( $id_or_email->user_id ) )
		$user_id = (int) $id_or_email->user_id;
	if ( empty( $user_id ) )
		return $avatar;

	um_fetch_user( $user_id );

	$avatar = um_user( 'profile_photo', $size );

	return $avatar;
}
add_filter( 'get_avatar', 'um_get_avatar', 99999, 5 );


if ( ! function_exists( 'um_filter_get_avatar_url' ) ) {

	/**
	 * Replace Gravatar image URL to Ultimate member profile image URL if setting "Use Gravatars?" disabled
	 *
	 * @param string $url
	 * @param int $id_or_email
	 * @param array $args
	 * @return string
	 */
	function um_filter_get_avatar_url( $url, $id_or_email, $args ) {

		if ( is_numeric( $id_or_email ) && ! UM()->options()->get( 'use_gravatars' ) && preg_match( '/gravatar/i', $url ) ) {
			$data = um_get_user_avatar_data( $id_or_email, $args['size'] );
			if ( ! empty( $data['url'] ) ) {
				$url = $data['url'];
			}
		}

		return $url;
	}

	// hooked in the get_avatar_data function
	add_filter( 'get_avatar_url', 'um_filter_get_avatar_url', 20, 3 );
}
       ```
</div>
