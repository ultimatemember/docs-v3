import Link from 'next/link'
import { Tabs, Tab, Callout } from 'nextra-theme-docs'


<div class="phpdocumentor-element -file">
    ## um-filters-login.php

        

    <section class="phpdocumentor-functions">
### Functions
<div class="phpdocumentor-element -function - ">
 #### um_custom_wp_err_messages()
       

<div class="phpdocumentor-element-found-in">
    <Link href="../files/includes-core-um-filters-login.html#source-view.13">includes/core/um-filters-login.php</Link> : <span class="phpdocumentor-element-found-in__line">13</span>
</div>

<div class="phpdocumentor-summary">
Filter to customize errors
</div>


    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">um_custom_wp_err_messages</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$message`</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span>



    ##### Parameters
    <dl class="phpdocumentor-argument-list">
                    
                <span class="phpdocumentor-signature__argument__name">`$message`</span>
                : <span class="phpdocumentor-signature__argument__return-type"></span>
                            
           
                 

           
            </dl>



<div className="py-4"></div>

</div>
<div class="phpdocumentor-element -function - ">
 #### um_wp_form_errors_hook_ip_test()
       

<div class="phpdocumentor-element-found-in">
    <Link href="../files/includes-core-um-filters-login.html#source-view.44">includes/core/um-filters-login.php</Link> : <span class="phpdocumentor-element-found-in__line">44</span>
</div>

<div class="phpdocumentor-summary">
Check for blocked IPs or Email on wp-login.php form
</div>


    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">um_wp_form_errors_hook_ip_test</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$user`</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$username`</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$password`</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span>



    ##### Parameters
    <dl class="phpdocumentor-argument-list">
                    
                <span class="phpdocumentor-signature__argument__name">`$user`</span>
                : <span class="phpdocumentor-signature__argument__return-type"></span>
                            
           
                 

           
                    
                <span class="phpdocumentor-signature__argument__name">`$username`</span>
                : <span class="phpdocumentor-signature__argument__return-type"></span>
                            
           
                 

           
                    
                <span class="phpdocumentor-signature__argument__name">`$password`</span>
                : <span class="phpdocumentor-signature__argument__return-type"></span>
                            
           
                 

           
            </dl>



<div className="py-4"></div>

</div>
<div class="phpdocumentor-element -function - ">
 #### um_wp_form_errors_hook_logincheck()
       

<div class="phpdocumentor-element-found-in">
    <Link href="../files/includes-core-um-filters-login.html#source-view.64">includes/core/um-filters-login.php</Link> : <span class="phpdocumentor-element-found-in__line">64</span>
</div>

<div class="phpdocumentor-summary">
Login checks thru the wordpress admin login
</div>


    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">um_wp_form_errors_hook_logincheck</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$user`</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$username`</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$password`</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">\WP_Error|\WP_User</span>



    ##### Parameters
    <dl class="phpdocumentor-argument-list">
                    
                <span class="phpdocumentor-signature__argument__name">`$user`</span>
                : <span class="phpdocumentor-signature__argument__return-type"></span>
                            
           
                 

           
                    
                <span class="phpdocumentor-signature__argument__name">`$username`</span>
                : <span class="phpdocumentor-signature__argument__return-type"></span>
                            
           
                 

           
                    
                <span class="phpdocumentor-signature__argument__name">`$password`</span>
                : <span class="phpdocumentor-signature__argument__return-type"></span>
                            
           
                 

           
            </dl>



<div className="py-4"></div>

</div>
<div class="phpdocumentor-element -function - ">
 #### um_lostpassword_url()
       

<div class="phpdocumentor-element-found-in">
    <Link href="../files/includes-core-um-filters-login.html#source-view.99">includes/core/um-filters-login.php</Link> : <span class="phpdocumentor-element-found-in__line">99</span>
</div>

<div class="phpdocumentor-summary">
Change lost password url in UM Login form
</div>


    <span class="phpdocumentor-signature__visibility"></span>
                <span class="phpdocumentor-signature__name">um_lostpassword_url</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">`$lostpassword_url`</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span>



    ##### Parameters
    <dl class="phpdocumentor-argument-list">
                    
                <span class="phpdocumentor-signature__argument__name">`$lostpassword_url`</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            
           
                 

           
            </dl>



<div className="py-4"></div>

</div>
</section>

       ```php showLineNumbers=true copy
       <?php if ( ! defined( 'ABSPATH' ) ) {
	exit;
}


/**
 * Filter to customize errors
 *
 * @param $message
 *
 * @return string
 */
function um_custom_wp_err_messages( $message ) {

	if ( ! empty( $_REQUEST['err'] ) ) {
		switch ( sanitize_key( $_REQUEST['err'] ) ) {
			case 'blocked_email':
				$err = __( 'This email address has been blocked.', 'ultimate-member' );
				break;
			case 'blocked_ip':
				$err = __( 'Your IP address has been blocked.', 'ultimate-member' );
				break;
		}
	}

	if ( isset( $err ) ) {
		$message = '<div class="login" id="login_error">' . $err . '</div>';
	}

	return $message;
}
add_filter( 'login_message', 'um_custom_wp_err_messages' );


/**
 * Check for blocked IPs or Email on wp-login.php form
 *
 * @param $user
 * @param $username
 * @param $password
 *
 * @return mixed
 */
function um_wp_form_errors_hook_ip_test( $user, $username, $password ) {
	if ( ! empty( $username ) ) {
		do_action( 'um_submit_form_errors_hook__blockedips', array() );
		do_action( 'um_submit_form_errors_hook__blockedemails', array( 'username' => $username ) );
	}

	return $user;
}
add_filter( 'authenticate', 'um_wp_form_errors_hook_ip_test', 10, 3 );


/**
 * Login checks thru the wordpress admin login
 *
 * @param $user
 * @param $username
 * @param $password
 *
 * @return WP_Error|WP_User
 */
function um_wp_form_errors_hook_logincheck( $user, $username, $password ) {

	if ( isset( $user->ID ) ) {

		um_fetch_user( $user->ID );
		$status = um_user( 'account_status' );

		switch( $status ) {
			case 'inactive':
				return new WP_Error( $status, __( 'Your account has been disabled.', 'ultimate-member' ) );
				break;
			case 'awaiting_admin_review':
				return new WP_Error( $status, __( 'Your account has not been approved yet.', 'ultimate-member' ) );
				break;
			case 'awaiting_email_confirmation':
				return new WP_Error( $status, __( 'Your account is awaiting e-mail verification.', 'ultimate-member' ) );
				break;
			case 'rejected':
				return new WP_Error( $status, __( 'Your membership request has been rejected.', 'ultimate-member' ) );
				break;
		}

	}

	return $user;

}
add_filter( 'authenticate', 'um_wp_form_errors_hook_logincheck', 50, 3 );


/**
 * Change lost password url in UM Login form
 * @param  string $lostpassword_url 
 * @return string                  
 */
function um_lostpassword_url( $lostpassword_url ) {

	if ( um_is_core_page( 'login' ) ) {
		return um_get_core_page( 'password-reset' );
	}

	return $lostpassword_url;
}
add_filter( 'lostpassword_url', 'um_lostpassword_url', 10, 1 );

       ```
</div>
